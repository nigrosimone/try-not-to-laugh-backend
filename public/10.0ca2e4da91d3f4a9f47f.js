(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{Ev8k:function(t,e,i){"use strict";i.r(e),i.d(e,"CameraDetectionModule",function(){return g});var n=i("ofXK"),o=i("tyNb"),s=i("mrSG"),c=i("qzk7"),a=i("fXoL"),r=i("Xa2L");const d=["video"],h=["canvas"];function l(t,e){1&t&&(a.Mb(0,"div",5),a.Kb(1,"mat-spinner"),a.Lb())}const u=[{path:"",component:(()=>{class t{constructor(t){this.cdr=t,this.loading=!1,this.width=0,this.height=0,this.toolbar=document.getElementById("tnl-toolbar"),this.onResize()}ngOnDestroy(){this.stream&&this.stream.getTracks().forEach(t=>t.stop())}ngAfterViewInit(){this.run()}run(){return Object(s.a)(this,void 0,void 0,function*(){this.loading=!0,this.cdr.detectChanges(),this.stream=yield navigator.mediaDevices.getUserMedia({video:{}}),this.video.nativeElement.srcObject=this.stream;const t="/assets/weights/";yield Promise.all([c.e.tinyFaceDetector.loadFromUri(t),c.e.faceRecognitionNet.loadFromUri(t),c.e.faceExpressionNet.loadFromUri(t)]),this.loading=!1,this.cdr.detectChanges()})}onPlay(){return Object(s.a)(this,void 0,void 0,function*(){const t=this.video.nativeElement,e=this.canvas.nativeElement;if(this.onResize(),t.paused||t.ended||!c.e.tinyFaceDetector.params)return requestAnimationFrame(()=>this.onPlay());const i=yield c.b(t,new c.a).withFaceExpressions();if(i){e.style.display="block";const n=c.d(e,t,!0),o=c.f(i,n),s=.05;c.c.drawDetections(e,o),c.c.drawFaceExpressions(e,o,s)}else e.style.display="none";requestAnimationFrame(()=>this.onPlay())})}onResize(){const t=document.documentElement.clientWidth-1,e=document.documentElement.clientHeight-this.toolbar.clientHeight-1;t===this.width&&e===this.height||(this.width=t,this.height=e,this.cdr.markForCheck())}}return t.\u0275fac=function(e){return new(e||t)(a.Jb(a.h))},t.\u0275cmp=a.Db({type:t,selectors:[["app-camera-detection"]],viewQuery:function(t,e){if(1&t&&(a.sc(d,!0),a.sc(h,!0)),2&t){let t;a.dc(t=a.Ub())&&(e.video=t.first),a.dc(t=a.Ub())&&(e.canvas=t.first)}},hostBindings:function(t,e){1&t&&a.Tb("resize",function(){return e.onResize()},!1,a.gc)},decls:6,vars:12,consts:[["class","spinner",4,"ngIf"],[1,"video-container",3,"hidden"],["autoplay","","muted","","playsinline","",3,"width","height","loadedmetadata"],["video",""],["canvas",""],[1,"spinner"]],template:function(t,e){1&t&&(a.oc(0,l,2,0,"div",0),a.Mb(1,"div",1),a.Mb(2,"video",2,3),a.Tb("loadedmetadata",function(){return e.onPlay()}),a.Lb(),a.Kb(4,"canvas",null,4),a.Lb()),2&t&&(a.cc("ngIf",e.loading),a.zb(1),a.cc("hidden",e.loading),a.zb(1),a.lc("height",e.height+"px")("width",e.width+"px"),a.cc("width",e.width)("height",e.height),a.zb(2),a.lc("height",e.height+"px")("width",e.width+"px"))},directives:[n.k,r.b],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}.spinner[_ngcontent-%COMP%]{margin:auto}.video-container[_ngcontent-%COMP%]{position:relative}.video-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%], .video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute;top:0;left:0}"]}),t})()}];let m=(()=>{class t{}return t.\u0275mod=a.Hb({type:t}),t.\u0275inj=a.Gb({factory:function(e){return new(e||t)},imports:[[o.b.forChild(u)],o.b]}),t})(),g=(()=>{class t{}return t.\u0275mod=a.Hb({type:t}),t.\u0275inj=a.Gb({factory:function(e){return new(e||t)},imports:[[n.c,m,r.a]]}),t})()}}]);