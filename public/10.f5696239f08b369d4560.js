(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{Ev8k:function(e,t,n){"use strict";n.r(t),n.d(t,"CameraDetectionModule",function(){return p});var i=n("ofXK"),o=n("tyNb"),s=n("mrSG"),a=n("qzk7"),c=n("fXoL"),r=n("Xa2L");const d=["video"],l=["canvas"];function u(e,t){1&e&&c.Kb(0,"mat-spinner")}const m=[{path:"",component:(()=>{class e{constructor(e){this.cdr=e,this.loading=!1}ngOnDestroy(){this.stream&&this.stream.getTracks().forEach(e=>e.stop())}ngAfterViewInit(){this.run()}run(){return Object(s.a)(this,void 0,void 0,function*(){const e=(document.getElementsByTagName("base")[0]||{}).href;let t="/assets/weights/";e&&(t=e+t.substring(1)),this.loading=!0,this.cdr.detectChanges(),yield Promise.all([a.e.tinyFaceDetector.loadFromUri(t),a.e.faceRecognitionNet.loadFromUri(t),a.e.faceExpressionNet.loadFromUri(t)]),this.loading=!1,this.cdr.detectChanges(),this.stream=yield navigator.mediaDevices.getUserMedia({video:{}}),this.video.nativeElement.srcObject=this.stream})}onPlay(){return Object(s.a)(this,void 0,void 0,function*(){const e=this.video.nativeElement,t=this.canvas.nativeElement;if(e.paused||e.ended||!a.e.tinyFaceDetector.params)return requestAnimationFrame(()=>this.onPlay());const n=yield a.b(e,new a.a).withFaceExpressions();if(console.log("detectSingleFace",null==n?void 0:n.expressions),n){t.style.display="block";const i=a.d(t,e,!0),o=a.f(n,i),s=.05;a.c.drawDetections(t,o),a.c.drawFaceExpressions(t,o,s)}else t.style.display="none";requestAnimationFrame(()=>this.onPlay())})}}return e.\u0275fac=function(t){return new(t||e)(c.Jb(c.h))},e.\u0275cmp=c.Db({type:e,selectors:[["app-camera-detection"]],viewQuery:function(e,t){if(1&e&&(c.sc(d,!0),c.sc(l,!0)),2&e){let e;c.dc(e=c.Ub())&&(t.video=e.first),c.dc(e=c.Ub())&&(t.canvas=e.first)}},decls:6,vars:1,consts:[[4,"ngIf"],[1,"video-container"],["autoplay","","muted","","playsinline","",3,"loadedmetadata"],["video",""],["canvas",""]],template:function(e,t){1&e&&(c.oc(0,u,1,0,"mat-spinner",0),c.Mb(1,"div",1),c.Mb(2,"video",2,3),c.Tb("loadedmetadata",function(){return t.onPlay()}),c.Lb(),c.Kb(4,"canvas",null,4),c.Lb()),2&e&&c.cc("ngIf",t.loading)},directives:[i.k,r.c],styles:[".video-container[_ngcontent-%COMP%]{position:relative}.video-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%], .video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute;top:0;left:0}"]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[o.b.forChild(m)],o.b]}),e})(),p=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[i.c,v,r.b]]}),e})()}}]);