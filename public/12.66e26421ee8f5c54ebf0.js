(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"1lbk":function(e,t,n){"use strict";n.r(t),n.d(t,"ExpressionTrainingModule",function(){return O});var i=n("ofXK"),o=n("tyNb"),a=n("lM/l"),c=n("fXoL"),s=n("tpjD"),r=n("eVtn");const h=["cameraDetection"];function d(e,t){if(1&e&&(c.Mb(0,"h1"),c.oc(1),c.Lb()),2&e){const e=c.Wb();c.zb(1),c.rc('Hai perso, dovevi fare una faccia "',e.targetExpression.label,'" invece ne hai fatta una "',e.loseExpression.label,'"!')}}function g(e,t){1&e&&(c.Mb(0,"h1"),c.oc(1,"Hai vinto!"),c.Lb())}function l(e,t){1&e&&(c.Mb(0,"h1"),c.oc(1,"Non riesco a vedere la tua faccia!"),c.Lb())}function f(e,t){if(1&e&&(c.Mb(0,"h1"),c.oc(1),c.Lb()),2&e){const e=c.Wb();c.zb(1),c.qc("Fai una faccia: ",e.targetExpression.label,"")}}function b(e,t){1&e&&(c.Mb(0,"h1"),c.oc(1,"Bravo! adesso torna con una espressione normale"),c.Lb())}const u=[{expression:"happy",label:"felice"},{expression:"sad",label:"triste"},{expression:"angry",label:"arrabbiato"},{expression:"fearful",label:"spaventato"},{expression:"disgusted",label:"disgustato"},{expression:"surprised",label:"sorpreso"}],p=[{path:"",component:(()=>{class e{constructor(e,t,n){this.cdr=e,this.windowService=t,this.elRef=n,this.targetExpression=Object(a.a)(u),this.neutralRequested=!1,this.faceDetected=!1,this.faceMissingDetection=0,this.firstDetectionHappen=!1,this.detectionReady=!1,this.allReady=!1,this.endMatch=!1,this.loseMatch=!1,this.winMatch=!1,this.readyToGame=!1,this.width=0,this.height=0}ngOnInit(){this.subVwChanges=this.windowService.viewPortChanges.subscribe(()=>{this.doResize()})}ngOnDestroy(){Object(a.b)(this.subVwChanges)}onDetectionReady(e){this.detectionReady=!0,this.doThirdPartyOnReady()}doThirdPartyOnReady(){this.allReady=this.detectionReady,this.doResize()}onDetectionChanges(e){if(this.doResize(),e){this.firstDetectionHappen=!0,this.faceMissingDetection=0;let t=null,n=null;for(const i of u)e[i.expression]>.8&&(i.expression===this.targetExpression.expression?t=i:n=i);if(n)return this.loseExpression=n,void this.endGame(!1);t?this.neutralRequested=!0:this.neutralRequested&&e.neutral>.8&&(this.targetExpression=Object(a.a)(u),this.neutralRequested=!1)}else this.firstDetectionHappen&&this.faceMissingDetection++;this.manageDetectionState()}manageDetectionState(){let e=this.faceMissingDetection<10;this.firstDetectionHappen||(e=!1),this.faceDetected!==e&&(this.faceDetected=e,this.manageReadyToGameState(),this.cdr.markForCheck())}endGame(e){this.endMatch||(this.winMatch=e,this.loseMatch=!this.winMatch,this.endMatch=!0,this.cameraDetection.pauseVideo(),window.navigator.vibrate(200),this.manageReadyToGameState(),this.cdr.markForCheck())}manageReadyToGameState(){const e=!this.endMatch&&this.faceDetected;this.readyToGame!==e&&(this.readyToGame=e,this.cdr.markForCheck())}doResize(){const e=this.elRef.nativeElement.clientWidth-1,t=this.elRef.nativeElement.clientHeight-1;e===this.width&&t===this.height||(this.width=e,this.height=t,this.cdr.markForCheck())}}return e.\u0275fac=function(t){return new(t||e)(c.Jb(c.h),c.Jb(s.a),c.Jb(c.l))},e.\u0275cmp=c.Db({type:e,selectors:[["app-expression-training"]],viewQuery:function(e,t){if(1&e&&c.sc(h,!0),2&e){let e;c.dc(e=c.Ub())&&(t.cameraDetection=e.first)}},decls:10,vars:13,consts:[[1,"game-container"],[1,"info"],[4,"ngIf"],[1,"webcam"],[3,"width","height","drawDetection","detectionTimer","detectionReady","detectionChanges"],["cameraDetection",""]],template:function(e,t){1&e&&(c.Mb(0,"div",0),c.Mb(1,"div",1),c.nc(2,d,2,2,"h1",2),c.nc(3,g,2,0,"h1",2),c.nc(4,l,2,0,"h1",2),c.nc(5,f,2,1,"h1",2),c.nc(6,b,2,0,"h1",2),c.Lb(),c.Mb(7,"div",3),c.Mb(8,"app-camera-detection",4,5),c.Tb("detectionReady",function(e){return t.onDetectionReady(e)})("detectionChanges",function(e){return t.onDetectionChanges(e)}),c.Lb(),c.Lb(),c.Lb()),2&e&&(c.kc("width",t.width+"px")("height",t.height+"px"),c.zb(2),c.cc("ngIf",t.endMatch&&t.loseMatch),c.zb(1),c.cc("ngIf",t.endMatch&&t.winMatch),c.zb(1),c.cc("ngIf",t.detectionReady&&!t.endMatch&&!t.faceDetected),c.zb(1),c.cc("ngIf",t.faceDetected&&!t.endMatch&&!t.neutralRequested),c.zb(1),c.cc("ngIf",t.faceDetected&&!t.endMatch&&t.neutralRequested),c.zb(2),c.cc("width",t.width)("height",t.height)("drawDetection",!1)("detectionTimer",100))},directives:[i.k,r.a],styles:["[_nghost-%COMP%]{flex-direction:column}.game-container[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;height:100%;width:100%}.game-container[_ngcontent-%COMP%]{flex-direction:column;flex:1 1 auto;overflow:hidden}.game-container[_ngcontent-%COMP%]   .webcam[_ngcontent-%COMP%], .game-container[_ngcontent-%COMP%]   .youtube[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{width:100%;color:#000;position:absolute;bottom:10px;text-align:center;z-index:10000}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{background-color:#fff;padding:3px;border-radius:3px;margin-bottom:5px;display:inline}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .badge-container[_ngcontent-%COMP%]{width:100%}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .badge-container[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:3px;border-radius:3px;white-space:nowrap}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .badge-container[_ngcontent-%COMP%]   .badge-happy[_ngcontent-%COMP%]{color:#fff}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .badge-container[_ngcontent-%COMP%]   .badge-duration[_ngcontent-%COMP%], .game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .badge-container[_ngcontent-%COMP%]   .badge-record-duration[_ngcontent-%COMP%]{margin-left:5px}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .badge-container[_ngcontent-%COMP%]   .badge-duration[_ngcontent-%COMP%]{color:#fff}.game-container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .badge-container[_ngcontent-%COMP%]   .badge-record-duration[_ngcontent-%COMP%]{background:#ff0;color:#000}"]}),e})()}];let M=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[o.b.forChild(p)],o.b]}),e})();var m=n("8Vwt"),C=n("v6By");let O=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[i.c,M,m.a,C.a]]}),e})()}}]);